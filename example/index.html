<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vue3 Auto Scroll ç¤ºä¾‹</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }

    h1 {
      text-align: center;
      color: #333;
      margin-bottom: 30px;
    }

    .demo-section {
      background: white;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 30px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .demo-title {
      font-size: 18px;
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #3498db;
    }

    .scroll-container {
      height: 200px;
      border: 2px solid #e0e0e0;
      border-radius: 4px;
      overflow: hidden;
    }

    .scroll-insufficient-height {
      height: 600px;
      border: 2px solid #e0e0e0;
      border-radius: 4px;
      overflow: hidden;
    }

    .horizontal-container {
      height: 50px;
      border: 2px solid #e0e0e0;
      border-radius: 4px;
      overflow: hidden;
      margin-top: 10px;
    }

    .scroll-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 16px;
      border-bottom: 1px solid #f0f0f0;
      background: #fafafa;
      transition: background 0.3s;
    }

    .scroll-item:hover {
      background: #e3f2fd;
    }

    .horizontal-item {
      display: inline-block;
      padding: 0 30px;
      line-height: 50px;
      white-space: nowrap;
      font-weight: 500;
      color: #2196f3;
    }

    .controls {
      margin-top: 15px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    button {
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      background: #3498db;
      color: white;
      cursor: pointer;
      font-size: 14px;
      transition: background 0.3s;
    }

    button:hover {
      background: #2980b9;
    }

    button:active {
      transform: scale(0.98);
    }

    .info {
      margin-top: 10px;
      padding: 10px;
      background: #e8f5e9;
      border-radius: 4px;
      font-size: 14px;
      color: #2e7d32;
    }

    .description {
      margin-bottom: 15px;
      padding: 10px;
      background: #fff3e0;
      border-radius: 4px;
      font-size: 14px;
      color: #e65100;
    }
  </style>
  <link rel="stylesheet" href="../dist/style.css">
  <script src="https://unpkg.com/vue@3.4.0/dist/vue.global.js"></script>
  <script src="../dist/vue3-auto-scroll.umd.js"></script>
</head>

<body>
  <div id="app">
    <h1>Vue3 Auto Scroll ç»„ä»¶æµ‹è¯•</h1>

    <!-- è°ƒè¯•ä¿¡æ¯åŒºåŸŸ -->
    <div class="demo-section" style="background: #fff3e0; border: 2px solid #ff9800;">
      <div class="demo-title">ğŸ”§ è°ƒè¯•æ§åˆ¶å°</div>
      <div style="padding: 15px; font-family: monospace; font-size: 14px;">
        <div><strong>ç»„ä»¶çŠ¶æ€ï¼š</strong>{{ debugStatus }}</div>
        <div><strong>é”™è¯¯ä¿¡æ¯ï¼š</strong>{{ debugError }}</div>
        <div style="margin-top: 10px;">
          <button @click="manualStart" style="background: #4caf50;">æ‰‹åŠ¨å¯åŠ¨æ»šåŠ¨</button>
          <button @click="checkComponents" style="background: #ff9800;">æ£€æŸ¥ç»„ä»¶</button>
          <button @click="forceResize" style="background: #2196f3;">å¼ºåˆ¶é‡ç»˜</button>
        </div>
      </div>
    </div>

    <!-- åŸºç¡€æ»šåŠ¨ç¤ºä¾‹ -->
    <div class="demo-section">
      <div class="demo-title">1. åŸºç¡€è‡ªåŠ¨æ»šåŠ¨ï¼ˆå‘ä¸Šï¼‰</div>
      <div class="description">è‡ªåŠ¨å‘ä¸Šæ»šåŠ¨ï¼Œé¼ æ ‡æ‚¬åœä¼šæš‚åœï¼Œç§»å‡ºåæ¢å¤æ»šåŠ¨</div>
      <div class="scroll-container">
        <vue3-auto-scroll :list="listData" :steep="1" ref="scroll1">
          <template #scrollItem="{ item, index }">
            <div class="scroll-item">
              <span>{{ item.title }}</span>
              <span style="color: #999; font-size: 12px;">{{ item.time }}</span>
            </div>
          </template>
        </vue3-auto-scroll>
      </div>
      <div class="info">âœ¨ æç¤ºï¼šå°†é¼ æ ‡ç§»å…¥æ»šåŠ¨åŒºåŸŸå¯ä»¥æš‚åœæ»šåŠ¨</div>
    </div>

    <!-- æ¨ªå‘æ»šåŠ¨ç¤ºä¾‹ -->
    <div class="demo-section">
      <div class="demo-title">2. æ¨ªå‘æ»šåŠ¨ï¼ˆå‘å·¦ï¼‰</div>
      <div class="description">æ¨ªå‘æ— ç¼æ»šåŠ¨ï¼Œé€‚ç”¨äºå…¬å‘Šæ ç­‰åœºæ™¯</div>
      <div class="horizontal-container">
        <vue3-auto-scroll :force-scroll="true" :list="horizontalData" scroll-direction="left" :steep="2" ref="scroll2">
          <template #scrollItem="{ item }">
            <span class="horizontal-item">{{ item.text }}</span>
          </template>
        </vue3-auto-scroll>
      </div>
    </div>


    <!-- å¤–éƒ¨æ§åˆ¶ç¤ºä¾‹ -->
    <div class="demo-section">
      <div class="demo-title">3. å¤–éƒ¨æ§åˆ¶</div>
      <div class="description">é€šè¿‡æŒ‰é’®æ§åˆ¶æ»šåŠ¨çš„å¼€å§‹ã€åœæ­¢å’Œé‡ç½®</div>
      <div class="scroll-container">
        <vue3-auto-scroll :is-hover-stop="true" ref="scrollRef" :list="listData" :auto-play="false" :steep="1.5">
          <template #scrollItem="{ item }">
            <div class="scroll-item">
              <span>{{ item.title }}</span>
              <span style="color: #999; font-size: 12px;">{{ item.time }}</span>
            </div>
          </template>
        </vue3-auto-scroll>
      </div>
      <div class="controls">
        <button @click="startScroll">å¼€å§‹æ»šåŠ¨</button>
        <button @click="stopScroll">åœæ­¢æ»šåŠ¨</button>
        <button @click="resetScroll">é‡ç½®ä½ç½®</button>
      </div>
    </div>

    <!-- å•æ­¥æ»šåŠ¨ç¤ºä¾‹ -->
    <div class="demo-section">
      <div class="demo-title">4. å•æ­¥æ»šåŠ¨æ¨¡å¼</div>
      <div class="description">æ¯æ¬¡æ»šåŠ¨å›ºå®šè·ç¦»ï¼Œç„¶ååœé¡¿ä¸€æ®µæ—¶é—´</div>
      <div class="scroll-container">
        <vue3-auto-scroll :list="listData" :is-single-step="true" :single-step-delay="2000" :steep="0" ref="scroll4">
          <template #scrollItem="{ item, index }">
            <div class="scroll-item">
              <span>{{ item.title }}</span>
              <span style="color: #999; font-size: 12px;">#{{ index + 1 }}</span>
            </div>
          </template>
        </vue3-auto-scroll>
      </div>
      <div class="info">â° æ¯è¡Œåœé¡¿ 2 ç§’é’Ÿ</div>
    </div>

    <!-- æ»šè½®æ§åˆ¶ç¤ºä¾‹ -->
    <div class="demo-section">
      <div class="demo-title">5. æ»šè½®æ§åˆ¶</div>
      <div class="description">ä½¿ç”¨é¼ æ ‡æ»šè½®æ‰‹åŠ¨æ»šåŠ¨ï¼Œåœæ­¢æ»šåŠ¨åè‡ªåŠ¨æ¢å¤</div>
      <div class="scroll-container">
        <vue3-auto-scroll :list="listData" :is-roller="true" :wheel-resume-delay="1000" :steep="1" ref="scroll5">
          <template #scrollItem="{ item }">
            <div class="scroll-item">
              <span>{{ item.title }}</span>
              <span style="color: #999; font-size: 12px;">{{ item.time }}</span>
            </div>
          </template>
        </vue3-auto-scroll>
      </div>
      <div class="info">ğŸ–±ï¸ ä½¿ç”¨é¼ æ ‡æ»šè½®æ»šåŠ¨ï¼Œåœæ­¢å 1 ç§’è‡ªåŠ¨æ¢å¤</div>
    </div>

    <!-- æ•°æ®é«˜åº¦ä¸è¶³ç¤ºä¾‹ -->
    <div class="demo-section">
      <div class="demo-title">6. é«˜åº¦ä¸å¤Ÿä¸æ»šåŠ¨</div>
      <div class="description">é«˜åº¦ä¸å¤Ÿçš„æƒ…å†µï¼Œä¸è§¦å‘æ»šåŠ¨</div>
      <div class="scroll-insufficient-height">
        <vue3-auto-scroll :list="listData" :steep="1" ref="scroll1">
          <template #scrollItem="{ item, index }">
            <div class="scroll-item">
              <span>{{ item.title }}</span>
              <span style="color: #999; font-size: 12px;">{{ item.time }}</span>
            </div>
          </template>
        </vue3-auto-scroll>
      </div>
      <div class="info">âœ¨ æç¤ºï¼šå°†é¼ æ ‡ç§»å…¥æ»šåŠ¨åŒºåŸŸå¯ä»¥æš‚åœæ»šåŠ¨</div>
    </div>
  </div>
  <script>
    const { createApp, ref, onMounted } = Vue;

    // ç”Ÿæˆç¤ºä¾‹æ•°æ®
    function generateData(count) {
      const data = [];
      const now = new Date();
      for (let i = 1; i <= count; i++) {
        data.push({
          title: `Vue3 Auto Scroll ç¤ºä¾‹æ•°æ®ç¬¬ ${i} æ¡`,
          time: new Date(now.getTime() + i * 60000).toLocaleTimeString()
        });
      }
      return data;
    }

    createApp({
      setup() {
        // è°ƒè¯•çŠ¶æ€
        const debugStatus = ref('æ­£åœ¨åˆå§‹åŒ–...');
        const debugError = ref('æ— ');

        // æ•°æ®
        const listData = ref(generateData(20));
        const horizontalData = ref([
          { text: "ğŸ“¢ å…¬å‘Š1ï¼šæ¬¢è¿ä½¿ç”¨ Vue3 Auto Scroll ç»„ä»¶ï¼" },
          { text: "ğŸš€ å…¬å‘Š2ï¼šæ”¯æŒæ— ç¼æ»šåŠ¨ã€æ‚¬åœæš‚åœã€æ»šè½®æ§åˆ¶ï¼" },
          { text: "âœ¨ å…¬å‘Š3ï¼šå®Œç¾æ”¯æŒ TypeScriptï¼" },
          { text: "ğŸ¯ å…¬å‘Š4ï¼šæä¾›ä¸°å¯Œçš„ API å’Œé…ç½®é€‰é¡¹ï¼" },
          { text: "ğŸ’¡ å…¬å‘Š5ï¼šè½»æ¾é›†æˆåˆ° Vue3 é¡¹ç›®ä¸­ï¼" }
        ]);

        // è·å–ç»„ä»¶å¼•ç”¨
        const scrollRef = ref(null);
        const scroll1 = ref(null);
        const scroll2 = ref(null);

        // æ§åˆ¶æ–¹æ³•
        const startScroll = () => {
          debugStatus.value = 'å°è¯•å¯åŠ¨æ»šåŠ¨...';
          try {
            scrollRef.value?.start();
            debugStatus.value = 'æ»šåŠ¨å·²å¯åŠ¨';
          } catch (e) {
            debugError.value = 'å¯åŠ¨å¤±è´¥: ' + e.message;
          }
        };

        const stopScroll = () => {
          scrollRef.value?.stop();
          debugStatus.value = 'æ»šåŠ¨å·²åœæ­¢';
        };

        const resetScroll = () => {
          debugStatus.value = 'æ­£åœ¨é‡ç½®...';
          scrollRef.value?.initData();
          debugStatus.value = 'é‡ç½®å®Œæˆ';
        };

        // è°ƒè¯•æ–¹æ³•
        const manualStart = () => {
          debugStatus.value = 'æ‰‹åŠ¨è°ƒç”¨ start()...';
          if (scroll1.value) {
            scroll1.value.start();
            debugStatus.value = 'ç¬¬ä¸€ä¸ªç»„ä»¶ start() å·²è°ƒç”¨';
          } else {
            debugError.value = 'scroll1 ref ä¸º null';
          }
        };

        const checkComponents = () => {
          debugStatus.value = 'æ£€æŸ¥ç»„ä»¶çŠ¶æ€...';
          const checks = [
            { name: 'scroll1', value: scroll1.value },
            { name: 'scroll2', value: scroll2.value },
            { name: 'scrollRef', value: scrollRef.value }
          ];

          const results = checks.map(c => `${c.name}: ${c.value ? 'âœ… æœ‰å€¼' : 'âŒ null'}`).join(', ');
          debugStatus.value = results;

          if (!scroll1.value) {
            debugError.value = 'ç»„ä»¶å¼•ç”¨å¤±è´¥ï¼æ£€æŸ¥ ref æ˜¯å¦å·²æ·»åŠ åˆ°ç»„ä»¶ä¸Š';
          }
        };

        const forceResize = () => {
          debugStatus.value = 'å¼ºåˆ¶é‡ç»˜...';
          window.dispatchEvent(new Event('resize'));
          scroll1.value?.resize();
          scroll2.value?.resize();
          debugStatus.value = 'é‡ç»˜å®Œæˆ';
        };

        // ç»„ä»¶æŒ‚è½½åçš„æ£€æŸ¥
        onMounted(() => {
          debugStatus.value = 'ç»„ä»¶å·²æŒ‚è½½ï¼Œç­‰å¾…æ£€æŸ¥...';

          setTimeout(() => {
            checkComponents();

            if (scroll1.value) {
              debugStatus.value = 'âœ… ç»„ä»¶åŠ è½½æˆåŠŸï¼Œå‡†å¤‡å¯åŠ¨æ»šåŠ¨';
              // å¦‚æœè‡ªåŠ¨æ»šåŠ¨æ²¡å¯åŠ¨ï¼Œæ‰‹åŠ¨å¯åŠ¨
              if (listData.value.length > 0) {
                debugStatus.value += '\næ•°æ®åŠ è½½å®Œæˆï¼Œæ¡æ•°: ' + listData.value.length;
              }
            } else {
              debugError.value = 'å…³é”®é”™è¯¯ï¼šç»„ä»¶å¼•ç”¨ä¸º nullï¼';
            }
          }, 1000);
        });

        // æ·»åŠ æ›´å¤šæ•°æ®ï¼ˆç”¨äºæµ‹è¯•åŠ¨æ€æ›´æ–°ï¼‰
        setTimeout(() => {
          listData.value.push({
            title: "ğŸ‰ åŠ¨æ€æ·»åŠ çš„æ•°æ®",
            time: new Date().toLocaleTimeString()
          });
          debugStatus.value += '\nå·²æ·»åŠ æ–°æ•°æ®';
        }, 5000);

        return {
          listData,
          horizontalData,
          scrollRef,
          scroll1,
          scroll2,
          startScroll,
          stopScroll,
          resetScroll,
          debugStatus,
          debugError,
          manualStart,
          checkComponents,
          forceResize
        };
      }
    })
      .component('vue3-auto-scroll', Vue3AutoScroll.Vue3AutoScroll)
      .mount('#app');
  </script>
</body>

</html>